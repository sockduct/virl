<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<topology xmlns="http://www.cisco.com/VIRL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" schemaVersion="0.9" xsi:schemaLocation="http://www.cisco.com/VIRL https://raw.github.com/CiscoVIRL/schema/v0.9/virl.xsd">
    <extensions>
        <entry key="management_network" type="String">exclusive</entry>
        <entry key="AutoNetkit.enable_cdp" type="Boolean">true</entry>
        <entry key="AutoNetkit.enable_routing" type="Boolean">false</entry>
        <entry key="AutoNetkit.address_family" type="String">v4</entry>
    </extensions>
    <node name="student1s" type="SIMPLE" subtype="IOSvL2" location="52,123">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:42:41 UTC Fri May 20 2016
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
service compress-config
!
hostname student1s
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
username student password 0 cisco
no aaa new-model
!
!
!
!
!
vtp domain virl.lab
vtp mode transparent
!
!
!
no ip domain-lookup
ip domain-name lab
ip cef
no ipv6 cef
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 2
 name ank_vlan2
!
vlan 11
 name Student1toTeacher
!
vlan 25
 name Servers
!
vlan 102
 name InterStuSwitch1to2
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/1
 description to student1r
 switchport access vlan 2
 switchport mode access
 media-type rj45
 duplex full
 no negotiation auto
!
interface GigabitEthernet0/2
 description to Teacher
 switchport trunk allowed vlan 11
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/3
 description to student2s
 switchport trunk allowed vlan 25,102
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/0
 description OOB management
 no switchport
 vrf forwarding Mgmt-intf
 ip address 10.255.1.11 255.255.0.0
 negotiation auto
 no cdp enable
!
interface Vlan2
 ip address 172.18.1.254 255.255.255.0
!
interface Vlan11
 ip address 172.18.21.254 255.255.255.0
!
interface Vlan102
 ip address 172.18.10.1 255.255.255.248
!
!
router eigrp 101
 network 172.18.0.0
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
!
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
event manager session cli username "autobot"
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1"/>
        <interface id="1" name="GigabitEthernet0/2"/>
        <interface id="2" name="GigabitEthernet0/3"/>
    </node>
    <node name="student2s" type="SIMPLE" subtype="IOSvL2" location="160,124">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:44:08 UTC Fri May 20 2016
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
service compress-config
!
hostname student2s
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
username student password 0 cisco
no aaa new-model
!
!
!
!
!
vtp domain virl.lab
vtp mode transparent
!
!
!
no ip domain-lookup
ip domain-name lab
ip cef
no ipv6 cef
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 2
 name ank_vlan2
!
vlan 12
 name Student2toTeacher
!
vlan 25
 name Servers
!
vlan 102
 name InterStuSwitch1to2
!
vlan 203
 name InterStuSwitch2to3
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/1
 description to student2r
 switchport access vlan 2
 switchport mode access
 media-type rj45
 duplex full
 no negotiation auto
!
interface GigabitEthernet0/2
 description to Teacher
 switchport trunk allowed vlan 12
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/3
 description to student1s
 switchport trunk allowed vlan 25,102
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/0
 description OOB management
 no switchport
 vrf forwarding Mgmt-intf
 ip address 10.255.1.12 255.255.0.0
 negotiation auto
 no cdp enable
!
interface GigabitEthernet1/0
 description to student3s
 switchport trunk allowed vlan 25,203
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface Vlan2
 ip address 172.18.2.254 255.255.255.0
!
interface Vlan12
 ip address 172.18.22.254 255.255.255.0
!
interface Vlan102
 ip address 172.18.10.2 255.255.255.248
!
interface Vlan203
 ip address 172.18.10.9 255.255.255.248
!
!
router eigrp 101
 network 172.18.0.0
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
!
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1"/>
        <interface id="1" name="GigabitEthernet0/2"/>
        <interface id="2" name="GigabitEthernet0/3"/>
        <interface id="3" name="GigabitEthernet1/0"/>
    </node>
    <node name="student3s" type="SIMPLE" subtype="IOSvL2" location="249,126">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:44:44 UTC Fri May 20 2016
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
service compress-config
!
hostname student3s
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
username student password 0 cisco
no aaa new-model
!
!
!
!
!
vtp mode transparent
!
!
!
no ip domain-lookup
ip domain-name lab
ip cef
no ipv6 cef
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 2
 name ank_vlan2
!
vlan 13
 name Student1toTeacher
!
vlan 25
 name Servers
!
vlan 203
 name InterStuSwitch2to3
!
vlan 304
 name InterStuSwitch3to4
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/1
 description to student3r
 switchport access vlan 2
 switchport mode access
 media-type rj45
 duplex full
 no negotiation auto
!
interface GigabitEthernet0/2
 description to Teacher
 switchport trunk allowed vlan 13
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/3
 description to student2s
 switchport trunk allowed vlan 25,203
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/0
 description OOB management
 no switchport
 vrf forwarding Mgmt-intf
 ip address 10.255.1.13 255.255.0.0
 negotiation auto
 no cdp enable
!
interface GigabitEthernet1/0
 description to student4s
 switchport trunk allowed vlan 25,304
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet1/1
 media-type rj45
 negotiation auto
!
interface Vlan2
 ip address 172.18.3.254 255.255.255.0
!
interface Vlan13
 ip address 172.18.23.254 255.255.255.0
!
interface Vlan203
 ip address 172.18.10.10 255.255.255.248
!
interface Vlan304
 ip address 172.18.10.17 255.255.255.248
!
!
router eigrp 101
 network 172.18.0.0
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
!
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1"/>
        <interface id="1" name="GigabitEthernet0/2"/>
        <interface id="2" name="GigabitEthernet0/3"/>
        <interface id="3" name="GigabitEthernet1/0"/>
        <interface id="4" name="GigabitEthernet1/1"/>
    </node>
    <node name="student4s" type="SIMPLE" subtype="IOSvL2" location="340,121">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:45:04 UTC Fri May 20 2016
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
service compress-config
!
hostname student4s
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
username student password 0 cisco
no aaa new-model
!
!
!
!
!
vtp domain virl.lab
vtp mode transparent
!
!
!
no ip domain-lookup
ip domain-name lab
ip cef
no ipv6 cef
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 2
 name ank_vlan2
!
vlan 14
 name Student4toTeacher
!
vlan 25
 name Servers
!
vlan 304
 name InterStuSwitch3to4
!
vlan 405
 name InterStuSwitch4to5
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/1
 description to student4r
 switchport access vlan 2
 switchport mode access
 media-type rj45
 duplex full
 no negotiation auto
!
interface GigabitEthernet0/2
 description to Teacher
 switchport trunk allowed vlan 14
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/3
 description to student3s
 switchport trunk allowed vlan 25,304
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/0
 description OOB management
 no switchport
 vrf forwarding Mgmt-intf
 ip address 10.255.1.14 255.255.0.0
 negotiation auto
 no cdp enable
!
interface GigabitEthernet1/0
 description to student5s
 switchport trunk allowed vlan 25,405
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet1/1
 description to lxc-1
 switchport access vlan 25
 switchport mode access
 media-type rj45
 duplex full
 no negotiation auto
!
interface GigabitEthernet1/2
 media-type rj45
 negotiation auto
!
interface Vlan2
 ip address 172.18.4.254 255.255.255.0
!
interface Vlan14
 ip address 172.18.24.254 255.255.255.0
!
interface Vlan304
 ip address 172.18.10.18 255.255.255.248
!
interface Vlan405
 ip address 172.18.10.25 255.255.255.248
!
!
router eigrp 101
 network 172.18.0.0
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
!
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1"/>
        <interface id="1" name="GigabitEthernet0/2"/>
        <interface id="2" name="GigabitEthernet0/3"/>
        <interface id="3" name="GigabitEthernet1/0"/>
        <interface id="4" name="GigabitEthernet1/1"/>
        <interface id="5" name="GigabitEthernet1/2"/>
    </node>
    <node name="student5s" type="SIMPLE" subtype="IOSvL2" location="433,124">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:46:16 UTC Fri May 20 2016
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
service compress-config
!
hostname student5s
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
username student password 0 cisco
no aaa new-model
!
!
!
!
!
vtp domain virl.lab
vtp mode transparent
!
!
!
no ip domain-lookup
ip domain-name lab
ip cef
no ipv6 cef
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 2
 name ank_vlan2
!
vlan 15
 name Student5toTeacher
!
vlan 25
 name Servers
!
vlan 405
 name InterStuSwitchrto5
!
vlan 506
 name InterStuSwitch5to6
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/1
 description to student5r
 switchport access vlan 2
 switchport mode access
 media-type rj45
 duplex full
 no negotiation auto
!
interface GigabitEthernet0/2
 description to Teacher
 switchport trunk allowed vlan 15
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/3
 description to student4s
 switchport trunk allowed vlan 25,405
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/0
 description OOB management
 no switchport
 vrf forwarding Mgmt-intf
 ip address 10.255.1.15 255.255.0.0
 negotiation auto
 no cdp enable
!
interface GigabitEthernet1/0
 description to student6s
 switchport trunk allowed vlan 25,506
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet1/1
 description to lxc-2
 switchport access vlan 25
 switchport mode access
 media-type rj45
 duplex full
 no negotiation auto
!
interface GigabitEthernet1/2
 media-type rj45
 negotiation auto
!
interface Vlan2
 ip address 172.18.5.254 255.255.255.0
!
interface Vlan15
 ip address 172.18.25.254 255.255.255.0
!
interface Vlan25
 ip address 172.18.8.1 255.255.255.0
!
interface Vlan405
 ip address 172.18.10.26 255.255.255.248
!
interface Vlan506
 ip address 172.18.10.33 255.255.255.248
!
!
router eigrp 101
 network 172.18.0.0
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
!
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1"/>
        <interface id="1" name="GigabitEthernet0/2"/>
        <interface id="2" name="GigabitEthernet0/3"/>
        <interface id="3" name="GigabitEthernet1/0"/>
        <interface id="4" name="GigabitEthernet1/1"/>
        <interface id="5" name="GigabitEthernet1/2"/>
    </node>
    <node name="student6s" type="SIMPLE" subtype="IOSvL2" location="537,121">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:46:23 UTC Fri May 20 2016
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
service compress-config
!
hostname student6s
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
username student password 0 cisco
no aaa new-model
!
!
!
!
!
vtp domain virl.lab
vtp mode transparent
!
!
!
no ip domain-lookup
ip domain-name lab
ip cef
no ipv6 cef
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 2
 name ank_vlan2
!
vlan 16
 name Student6toTeacher
!
vlan 25
 name Servers
!
vlan 506
 name InterStuSwitchrto5
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/1
 description to student6r
 switchport access vlan 2
 switchport mode access
 media-type rj45
 duplex full
 no negotiation auto
!
interface GigabitEthernet0/2
 description to Teacher
 switchport trunk allowed vlan 16
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/3
 description to student5s
 switchport trunk allowed vlan 25,506
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/0
 description OOB management
 no switchport
 vrf forwarding Mgmt-intf
 ip address 10.255.1.16 255.255.0.0
 negotiation auto
 no cdp enable
!
interface GigabitEthernet1/0
 media-type rj45
 negotiation auto
!
interface Vlan2
 ip address 172.18.6.254 255.255.255.0
!
interface Vlan16
 ip address 172.18.26.254 255.255.255.0
!
interface Vlan506
 ip address 172.18.10.34 255.255.255.248
!
!
router eigrp 101
 network 172.18.0.0
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
!
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1"/>
        <interface id="1" name="GigabitEthernet0/2"/>
        <interface id="2" name="GigabitEthernet0/3"/>
        <interface id="3" name="GigabitEthernet1/0"/>
    </node>
    <node name="student1r" type="SIMPLE" subtype="IOSv" location="57,203" ipv4="192.168.0.1">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:44:33 UTC Fri May 20 2016
!
version 15.6
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname student1r
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
no aaa new-model
ethernet lmi ce
!
!
!
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
!
!
!
!
!
!
!
!
!
!
no ip domain lookup
ip domain name lab
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
!
!
!
username cisco privilege 15 secret 5 $1$Ka1e$Oxz4cJIm0zz2kyI3fO.Q61
username student password 0 cisco
!
redundancy
!
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/0
 description OOB Management
 vrf forwarding Mgmt-intf
 ip address 10.255.1.1 255.255.0.0
 duplex full
 speed auto
 media-type rj45
 no cdp enable
!
interface GigabitEthernet0/1
 description to student1s
 no ip address
 shutdown
 duplex full
 speed auto
 media-type rj45
!
ip forward-protocol nd
!
!
no ip http server
no ip http secure-server
ip ssh server algorithm authentication password
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
no scheduler allocate
event manager session cli username "autobot"
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1" ipv4="10.0.0.1" netPrefixLenV4="16"/>
    </node>
    <node name="student2r" type="SIMPLE" subtype="IOSv" location="157,206" ipv4="192.168.0.2">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:45:47 UTC Fri May 20 2016
!
version 15.6
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname student2r
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
no aaa new-model
ethernet lmi ce
!
!
!
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
!
!
!
!
!
!
!
!
!
!
no ip domain lookup
ip domain name lab
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
!
!
!
username cisco privilege 15 secret 5 $1$SRaZ$1KAxlQdOMPDZSDC4gNbhG/
username student password 0 cisco
!
redundancy
!
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/0
 description OOB Management
 vrf forwarding Mgmt-intf
 ip address 10.255.1.2 255.255.0.0
 duplex full
 speed auto
 media-type rj45
 no cdp enable
!
interface GigabitEthernet0/1
 description to student2s
 no ip address
 shutdown
 duplex full
 speed auto
 media-type rj45
!
ip forward-protocol nd
!
!
no ip http server
no ip http secure-server
ip ssh server algorithm authentication password
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
no scheduler allocate
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1" ipv4="10.0.0.2" netPrefixLenV4="16"/>
    </node>
    <node name="student3r" type="SIMPLE" subtype="IOSv" location="251,200" ipv4="192.168.0.3">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:46:09 UTC Fri May 20 2016
!
version 15.6
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname student3r
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
no aaa new-model
ethernet lmi ce
!
!
!
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
!
!
!
!
!
!
!
!
!
!
no ip domain lookup
ip domain name lab
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
!
!
!
username cisco privilege 15 secret 5 $1$Zz5K$NNZ4q5n7sJQwcKp2GfFLB0
username student password 0 cisco
!
redundancy
!
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/0
 description OOB Management
 vrf forwarding Mgmt-intf
 ip address 10.255.1.3 255.255.0.0
 duplex full
 speed auto
 media-type rj45
 no cdp enable
!
interface GigabitEthernet0/1
 description to student3s
 no ip address
 shutdown
 duplex full
 speed auto
 media-type rj45
!
ip forward-protocol nd
!
!
no ip http server
no ip http secure-server
ip ssh server algorithm authentication password
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
no scheduler allocate
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1" ipv4="10.0.0.3" netPrefixLenV4="16"/>
    </node>
    <node name="student4r" type="SIMPLE" subtype="IOSv" location="345,202" ipv4="192.168.0.4">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:46:23 UTC Fri May 20 2016
!
version 15.6
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname student4r
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
no aaa new-model
ethernet lmi ce
!
!
!
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
!
!
!
!
!
!
!
!
!
!
no ip domain lookup
ip domain name lab
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
!
!
!
username cisco privilege 15 secret 5 $1$JEcb$X0N4g7C6wsqYGj5frPjdi1
username student password 0 cisco
!
redundancy
!
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/0
 description OOB Management
 vrf forwarding Mgmt-intf
 ip address 10.255.1.4 255.255.0.0
 duplex full
 speed auto
 media-type rj45
 no cdp enable
!
interface GigabitEthernet0/1
 description to student4s
 no ip address
 shutdown
 duplex full
 speed auto
 media-type rj45
!
ip forward-protocol nd
!
!
no ip http server
no ip http secure-server
ip ssh server algorithm authentication password
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
no scheduler allocate
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1" ipv4="10.0.0.4" netPrefixLenV4="16"/>
    </node>
    <node name="student5r" type="SIMPLE" subtype="IOSv" location="436,202" ipv4="192.168.0.5">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:46:34 UTC Fri May 20 2016
!
version 15.6
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname student5r
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
no aaa new-model
ethernet lmi ce
!
!
!
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
!
!
!
!
!
!
!
!
!
!
no ip domain lookup
ip domain name lab
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
!
!
!
username cisco privilege 15 secret 5 $1$M40F$RNJVrqiKcPiPi1rMyxwoe1
username student password 0 cisco
!
redundancy
!
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/0
 description OOB Management
 vrf forwarding Mgmt-intf
 ip address 10.255.1.5 255.255.0.0
 duplex full
 speed auto
 media-type rj45
 no cdp enable
!
interface GigabitEthernet0/1
 description to student5s
 no ip address
 shutdown
 duplex full
 speed auto
 media-type rj45
!
ip forward-protocol nd
!
!
no ip http server
no ip http secure-server
ip ssh server algorithm authentication password
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
no scheduler allocate
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1" ipv4="10.0.0.5" netPrefixLenV4="16"/>
    </node>
    <node name="student6r" type="SIMPLE" subtype="IOSv" location="544,200" ipv4="192.168.0.6">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:46:41 UTC Fri May 20 2016
!
version 15.6
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname student6r
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
no aaa new-model
ethernet lmi ce
!
!
!
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
!
!
!
!
!
!
!
!
!
!
no ip domain lookup
ip domain name lab
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
!
!
!
username cisco privilege 15 secret 5 $1$Rudh$juLi0fhgx3fUHANWLuHF50
username student password 0 cisco
!
redundancy
!
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/0
 description OOB Management
 vrf forwarding Mgmt-intf
 ip address 10.255.1.6 255.255.0.0
 duplex full
 speed auto
 media-type rj45
 no cdp enable
!
interface GigabitEthernet0/1
 description to student6s
 no ip address
 shutdown
 duplex full
 speed auto
 media-type rj45
!
ip forward-protocol nd
!
!
no ip http server
no ip http secure-server
ip ssh server algorithm authentication password
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
no scheduler allocate
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1" ipv4="10.0.0.6" netPrefixLenV4="16"/>
    </node>
    <node name="Teacher" type="SIMPLE" subtype="IOSvL2" location="302,38">
        <extensions>
            <entry key="AutoNetkit.mgmt_ip" type="string"></entry>
            <entry key="config" type="String">!
! Last configuration change at 12:46:17 UTC Fri May 20 2016
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
service compress-config
!
hostname teacher1d
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
username student password 0 cisco
no aaa new-model
!
!
!
!
!
vtp domain virl.lab
vtp mode transparent
!
!
!
no ip domain-lookup
ip domain-name lab
ip cef
no ipv6 cef
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 2
 name ank_vlan2
!
vlan 11
 name Student1toTeacher
!
vlan 12
 name Student2toTeacher
!
vlan 13
 name Student3toTeacher
!
vlan 14
 name Student4toTeacher
!
vlan 15
 name Student5toTeacher
!
vlan 16
 name Student6toTeacher
!
vlan 101
 name TeachertoServers
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
 description Loopback
 ip address 192.168.255.254 255.255.255.255
!
interface Loopback1
 ip address 192.0.2.254 255.255.255.255
!
interface GigabitEthernet0/1
 description to student1s
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/2
 description to student2s
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/3
 description to student3s
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/0
 description OOB management
 no switchport
 vrf forwarding Mgmt-intf
 ip address 10.255.1.21 255.255.0.0
 negotiation auto
 no cdp enable
!
interface GigabitEthernet1/0
 description to student4s
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet1/1
 description to student5s
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet1/2
 description to student6s
 switchport trunk encapsulation dot1q
 switchport mode trunk
 media-type rj45
 negotiation auto
!
interface GigabitEthernet1/3
 description to server-1
 switchport access vlan 101
 switchport mode access
 media-type rj45
 negotiation auto
 spanning-tree portfast edge
!
interface Vlan11
 ip address 172.18.21.1 255.255.255.0
!
interface Vlan12
 ip address 172.18.22.1 255.255.255.0
!
interface Vlan13
 ip address 172.18.23.1 255.255.255.0
!
interface Vlan14
 ip address 172.18.24.1 255.255.255.0
!
interface Vlan15
 ip address 172.18.25.1 255.255.255.0
!
interface Vlan16
 ip address 172.18.26.1 255.255.255.0
!
interface Vlan101
 ip address 172.18.101.1 255.255.255.0
!
!
router eigrp 101
 network 172.18.0.0
 network 192.0.2.0
 network 192.168.0.0 0.0.255.255
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
!
!
!
!
!
control-plane
!
banner exec `
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
event manager session cli username "autobot"
event manager applet EEM_Mgmt_Addr
 event syslog pattern "SYS-5-RESTART"
 action 0.1 info type routername
 action 0.2 comment Initialize result variables with "None" to represent no value
 action 0.3 set result "None"
 action 0.4 set result1 "None"
 action 0.5 set result2 "None"
 action 0.6 set ipbase "10.255.1"
 action 0.7 set rbase "0"
 action 0.8 set sbase "10"
 action 0.9 set dbase "20"
 action 1.0 set ipmask "255.255.0.0"
 action 1.1 set mgmtint "GigabitEthernet0/0"
 action 1.2 set autolow "1"
 action 1.3 set autohigh "10"
 action 1.4 set mgmtfail "Management interface address not configured - hostname number outside of automated range ($autolow-$autohigh) -"
 action 1.5 cli command "enable"
 action 2.0 regexp "([0-9]+)[^0-9]*([0-9]*)" "$_info_routername" result result1 result2
 action 2.1 comment If $result2 is now "", reset to "None" as can't get ne to work with ""
 action 2.2 if $result2 eq ""
 action 2.3  set result2 "None"
 action 2.4 end
 action 2.5 string index "$_info_routername" end
 action 2.6 set devtype "$_string_result"
 action 2.7 if $devtype eq "r"
 action 2.8  set devoffset "$rbase"
 action 2.9 elseif $devtype eq s
 action 3.0  set devoffset "$sbase"
 action 3.1 elseif $devtype eq d
 action 3.2  set devoffset "$dbase"
 action 3.3 else
 action 3.4  syslog priority informational msg "Unknown device type - expecting r|s|d, got $devtype - not setting management interface address"
 action 3.5  exit
 action 3.6 end
 action 3.7 if $result1 ne "None"
 action 3.8  add $devoffset $result1
 action 3.9  set devaddr "$_result"
 action 4.0 else
 action 4.1  set devaddr "None"
 action 4.2 end
 action 4.3 comment Expecting $result2 to still be "None"
 action 4.4 if $result2 eq "None"
 action 4.5  comment Expecting $result1 to be a number (not "None")
 action 4.6  if $result1 ne "None"
 action 4.7   if $result1 ge "$autolow"
 action 4.8    if $result1 le "$autohigh"
 action 4.9     cli command "configure terminal"
 action 5.0     cli command "interface $mgmtint"
 action 5.1     cli command "no shutdown"
 action 5.2     cli command "ip address $ipbase.$devaddr $ipmask"
 action 5.3     cli command "end"
 action 5.4     syslog priority informational msg "Management interface ($mgmtint) address configured by EEM based on hostname number and device type:  $ipbase.$devaddr"
 action 5.5     cli command "write mem"
 action 5.6    else
 action 5.7     syslog priority informational msg "$mgmtfail $devaddr"
 action 5.8    end
 action 5.9   else
 action 6.0    syslog priority informational msg "$mgmtfail $devaddr"
 action 6.1   end
 action 6.2  else
 action 6.3   syslog priority informational msg "Management interface address not configured - no number found in hostname."
 action 6.4  end
 action 6.5 else
 action 6.6  syslog priority informational msg "Management interface address not configured - hostname has more than one number embedded:  $result1, $result2..."
 action 6.7 end
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.1 set status "None"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 comment result is total regexp match, status is subgroup1 or what's in the parenthesis
 action 2.2 regexp "^SSH ([ED][a-z]+)" "$_cli_result" result status
 action 2.3 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  syslog priority informational msg "SSH keys generated by EEM Applet"
 action 3.5  comment "write mem" will fail if their is a confirmation prompt (some cases) - so put it last
 action 3.6  cli command "write mem"
 action 3.7 end
event manager applet EEM_Block_Flash_Erase1
 event cli pattern "write erase" sync no skip yes
 action 0.1 set cmd "write erase"
 action 1.0 puts "Warning:  IOSv has a bug where performaing a $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase2
 event cli pattern "erase nvram:" sync no skip yes
 action 0.1 set cmd "erase nvram:"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
event manager applet EEM_Block_Flash_Erase3
 event cli pattern "erase startup-config" sync no skip yes
 action 0.1 set cmd "erase startup-config"
 action 1.0 puts "Warning:  IOSv has a bug where performaing an $cmd will prevent saving the configuration (startup-config) - therefore I am ignorning this request."
 action 1.1 syslog priority informational msg "$cmd ignored due to IOSv implemenation bug - remove EEM Applet when bug resolved"
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1"/>
        <interface id="1" name="GigabitEthernet0/2"/>
        <interface id="2" name="GigabitEthernet0/3"/>
        <interface id="3" name="GigabitEthernet1/0"/>
        <interface id="4" name="GigabitEthernet1/1"/>
        <interface id="5" name="GigabitEthernet1/2"/>
        <interface id="6" name="GigabitEthernet1/3"/>
    </node>
    <node name="L2only" type="SIMPLE" subtype="IOSvL2" location="422,42">
        <extensions>
            <entry key="config" type="String">!
! Last configuration change at 17:26:34 UTC Fri Apr 8 2016
!
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
service compress-config
!
hostname L2only
!
boot-start-marker
boot-end-marker
!
!
vrf definition Mgmt-intf
 !
 address-family ipv4
 exit-address-family
 !
 address-family ipv6
 exit-address-family
!
enable password cisco
!
username student password 0 cisco
no aaa new-model
!
!
!
!
!
vtp domain virl.lab
vtp mode transparent
no ip routing
!
!
!
no ip domain-lookup
ip domain-name lab
no ip cef
no ipv6 cef
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 2
 name ank_vlan2
!
vlan 25
 name Servers
!
! 
!
!
!
!
!
!
!
!
!
!
!
!
interface GigabitEthernet0/1
 description to student3s
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/2
 description to student4s
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/3
 description to student5s
 media-type rj45
 negotiation auto
!
interface GigabitEthernet0/0
 description OOB management
 no switchport
 vrf forwarding Mgmt-intf
 ip address 10.255.1.31 255.255.0.0
 no ip route-cache
 negotiation auto
 no cdp enable
!
interface GigabitEthernet1/0
 description to student6s
 media-type rj45
 negotiation auto
!
ip forward-protocol nd
!
no ip http server
no ip http secure-server
!
!
!
!
!
!
control-plane
!
banner exec `C
**************************************************************************
*                                                                        *
*     Student lab                                                        *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner incoming `C
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
banner login `C
**************************************************************************
*                                                                        *
*     Student router lab                                                 *
*                                                                        *
*     Device:  $(hostname)                                                 *
*     Line:  $(line)                                                           *
*                                                                        *
**************************************************************************
`
!
line con 0
 password cisco
line aux 0
line vty 0 4
 exec-timeout 720 0
 password cisco
 login local
 transport input telnet ssh
!
event manager session cli username "autobot"
event manager applet EEM_SSH_Keygen authorization bypass
 event syslog pattern "SYS-5-RESTART"
 action 0.0 info type routername
 action 0.1 set status "none"
 action 1.0 cli command "enable"
 action 2.0 cli command "show ip ssh | include ^SSH"
 action 2.1 regexp "([ED][^ ]+)" "$_cli_result" result status
 action 2.2 syslog priority informational msg "SSH is currently $status"
 action 3.0 if $status eq "Disabled"
 action 3.1  cli command "configure terminal"
 action 3.2  cli command "crypto key generate rsa modulus 1024"
 action 3.3  cli command "end"
 action 3.4  cli command "write mem"
 action 3.5  syslog priority informational msg "SSH keys generated by EEM."
 action 4.0 end
!
end</entry>
        </extensions>
        <interface id="0" name="GigabitEthernet0/1"/>
        <interface id="1" name="GigabitEthernet0/2"/>
        <interface id="2" name="GigabitEthernet0/3"/>
        <interface id="3" name="GigabitEthernet1/0"/>
    </node>
    <node name="lxc-1" type="SIMPLE" subtype="lxc" location="93,34">
        <extensions>
            <entry key="config" type="string">#cloud-config
bootcmd:
- ln -s -t /etc/rc.d /etc/rc.local
hostname: lxc-1
manage_etc_hosts: true
runcmd:
- systemctl start rc-local
- sed -i '/^\s*PasswordAuthentication\s\+no/d' /etc/ssh/sshd_config
- echo "UseDNS no" &gt;&gt; /etc/ssh/sshd_config
- service ssh restart
- service sshd restart
- chmod u+s /usr/sbin/tcpdump
users:
- default
- gecos: User configured by VIRL Configuration Engine 0.21.6
  lock-passwd: false
  name: cisco
  plain-text-passwd: cisco
  shell: /bin/bash
  ssh-authorized-keys:
  - VIRL-USER-SSH-PUBLIC-KEY
  sudo: ALL=(ALL) ALL
write_files:
- path: /etc/systemd/system/dhclient@.service
  content: |
    [Unit]
    Description=Run dhclient on %i interface
    After=network.target
    [Service]
    Type=oneshot
    ExecStart=/sbin/dhclient %i -pf /var/run/dhclient.%i.pid -lf /var/lib/dhclient/dhclient.%i.lease
    RemainAfterExit=yes
  owner: root:root
  permissions: '0644'
- path: /etc/rc.local
  owner: root:root
  permissions: '0755'
  content: |-
    #!/bin/sh
    ifconfig eth1 up 172.18.8.11 netmask 255.255.255.0
    route add default gw 172.18.8.1
    exit 0
</entry>
        </extensions>
        <interface id="0" name="eth1" ipv4="172.18.8.11" netPrefixLenV4="24"/>
    </node>
    <node name="lxc-2" type="SIMPLE" subtype="lxc" location="546,33">
        <extensions>
            <entry key="config" type="string">#cloud-config
bootcmd:
- ln -s -t /etc/rc.d /etc/rc.local
hostname: lxc-2
manage_etc_hosts: true
runcmd:
- systemctl start rc-local
- sed -i '/^\s*PasswordAuthentication\s\+no/d' /etc/ssh/sshd_config
- echo "UseDNS no" &gt;&gt; /etc/ssh/sshd_config
- service ssh restart
- service sshd restart
- chmod u+s /usr/sbin/tcpdump
users:
- default
- gecos: User configured by VIRL Configuration Engine 0.21.6
  lock-passwd: false
  name: cisco
  plain-text-passwd: cisco
  shell: /bin/bash
  ssh-authorized-keys:
  - VIRL-USER-SSH-PUBLIC-KEY
  sudo: ALL=(ALL) ALL
write_files:
- path: /etc/systemd/system/dhclient@.service
  content: |
    [Unit]
    Description=Run dhclient on %i interface
    After=network.target
    [Service]
    Type=oneshot
    ExecStart=/sbin/dhclient %i -pf /var/run/dhclient.%i.pid -lf /var/lib/dhclient/dhclient.%i.lease
    RemainAfterExit=yes
  owner: root:root
  permissions: '0644'
- path: /etc/rc.local
  owner: root:root
  permissions: '0755'
  content: |-
    #!/bin/sh
    ifconfig eth1 up 172.18.8.12 netmask 255.255.255.0
    route add default gw 172.18.8.1
    exit 0
</entry>
        </extensions>
        <interface id="0" name="eth1" ipv4="172.18.8.12" netPrefixLenV4="24"/>
    </node>
    <node name="server-1" type="SIMPLE" subtype="server" location="195,23">
        <extensions>
            <entry key="config" type="String">#cloud-config
bootcmd:
- ln -s -t /etc/rc.d /etc/rc.local
hostname: server-1
manage_etc_hosts: true
runcmd:
- start ttyS0
- systemctl start getty@ttyS0.service
- systemctl start rc-local
- sed -i '/^\s*PasswordAuthentication\s\+no/d' /etc/ssh/sshd_config
- echo "UseDNS no" &gt;&gt; /etc/ssh/sshd_config
- service ssh restart
- service sshd restart
users:
- default
- gecos: User configured by VIRL Configuration Engine 0.21.6
  lock-passwd: false
  name: cisco
  plain-text-passwd: cisco
  shell: /bin/bash
  ssh-authorized-keys:
  - VIRL-USER-SSH-PUBLIC-KEY
  sudo: ALL=(ALL) ALL
write_files:
- path: /etc/init/ttyS0.conf
  owner: root:root
  content: |
    # ttyS0 - getty
    # This service maintains a getty on ttyS0 from the point the system is
    # started until it is shut down again.
    start on stopped rc or RUNLEVEL=[12345]
    stop on runlevel [!12345]
    respawn
    exec /sbin/getty -L 115200 ttyS0 vt102
  permissions: '0644'
- path: /etc/systemd/system/dhclient@.service
  content: |
    [Unit]
    Description=Run dhclient on %i interface
    After=network.target
    [Service]
    Type=oneshot
    ExecStart=/sbin/dhclient %i -pf /var/run/dhclient.%i.pid -lf /var/lib/dhclient/dhclient.%i.lease
    RemainAfterExit=yes
  owner: root:root
  permissions: '0644'
- path: /etc/rc.local
  owner: root:root
  permissions: '0755'
  content: |-
    #!/bin/sh
    ifconfig eth1 up 10.0.0.5 netmask 255.255.255.252
    exit 0
</entry>
        </extensions>
        <interface id="0" name="eth1" ipv4="10.0.0.5" netPrefixLenV4="30"/>
    </node>
    <connection dst="/virl:topology/virl:node[7]/virl:interface[1]" src="/virl:topology/virl:node[1]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[8]/virl:interface[1]" src="/virl:topology/virl:node[2]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[9]/virl:interface[1]" src="/virl:topology/virl:node[3]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[10]/virl:interface[1]" src="/virl:topology/virl:node[4]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[11]/virl:interface[1]" src="/virl:topology/virl:node[5]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[12]/virl:interface[1]" src="/virl:topology/virl:node[6]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[1]/virl:interface[2]" src="/virl:topology/virl:node[13]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[2]/virl:interface[2]" src="/virl:topology/virl:node[13]/virl:interface[2]"/>
    <connection dst="/virl:topology/virl:node[3]/virl:interface[2]" src="/virl:topology/virl:node[13]/virl:interface[3]"/>
    <connection dst="/virl:topology/virl:node[4]/virl:interface[2]" src="/virl:topology/virl:node[13]/virl:interface[4]"/>
    <connection dst="/virl:topology/virl:node[5]/virl:interface[2]" src="/virl:topology/virl:node[13]/virl:interface[5]"/>
    <connection dst="/virl:topology/virl:node[6]/virl:interface[2]" src="/virl:topology/virl:node[13]/virl:interface[6]"/>
    <connection dst="/virl:topology/virl:node[2]/virl:interface[3]" src="/virl:topology/virl:node[1]/virl:interface[3]"/>
    <connection dst="/virl:topology/virl:node[3]/virl:interface[3]" src="/virl:topology/virl:node[2]/virl:interface[4]"/>
    <connection dst="/virl:topology/virl:node[4]/virl:interface[3]" src="/virl:topology/virl:node[3]/virl:interface[4]"/>
    <connection dst="/virl:topology/virl:node[5]/virl:interface[3]" src="/virl:topology/virl:node[4]/virl:interface[4]"/>
    <connection dst="/virl:topology/virl:node[6]/virl:interface[3]" src="/virl:topology/virl:node[5]/virl:interface[4]"/>
    <connection dst="/virl:topology/virl:node[3]/virl:interface[5]" src="/virl:topology/virl:node[14]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[4]/virl:interface[6]" src="/virl:topology/virl:node[14]/virl:interface[2]"/>
    <connection dst="/virl:topology/virl:node[5]/virl:interface[6]" src="/virl:topology/virl:node[14]/virl:interface[3]"/>
    <connection dst="/virl:topology/virl:node[6]/virl:interface[4]" src="/virl:topology/virl:node[14]/virl:interface[4]"/>
    <connection dst="/virl:topology/virl:node[4]/virl:interface[5]" src="/virl:topology/virl:node[15]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[5]/virl:interface[5]" src="/virl:topology/virl:node[16]/virl:interface[1]"/>
    <connection dst="/virl:topology/virl:node[13]/virl:interface[7]" src="/virl:topology/virl:node[17]/virl:interface[1]"/>
</topology>
